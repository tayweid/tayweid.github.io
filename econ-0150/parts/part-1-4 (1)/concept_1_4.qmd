---
format:
  revealjs:
    css: custom.css
    transition: none
---

## ECON 0150 | Economic Data Analysis {.center}
<p class="subheader-center">The economist's data analysis skillset.</p>

<br>

### *Part 1.4 | Panel Data (Long Format)*

---

## What is Panel Data?
<p class="subheader">Data with repeated observations across groups or time</p>

<br>

::: {.incremental}
- **Panel data** tracks the same units (people, countries, stores) over time
- Also called **longitudinal data** or **time series cross-sectional data**
- Examples: GDP by country by year, sales by store by hour
- Can be stored in two formats: **Long** or **Wide**
:::

---

## Long Format
<p class="subheader">Each observation is a separate row</p>

```{python}
import pandas as pd
sales = pd.read_csv('data/Coffee_Sales_Reciepts.csv', index_col='transaction_id')
sales[['Hours', 'Shop']].head()
```

. . .

*> each transaction is a row; a column identifies the group*

---

## Long Format
<p class="subheader">Great for grouping and faceting</p>

<br>

::: {.incremental}
- Each row is one observation
- A column identifies which group each row belongs to
- Natural for: histograms, faceting, line graphs
- Use `hue='Group'` and `col='Group'` in seaborn
:::

---

## Hiring a Barista
<p class="subheader">Use Coffee_Sales_Receips.csv to help inform where to hire a barista.</p>

<br>

- You manage three coffee shops and are considering where to hire a new barista.
- You have a dataset containing information about the transactions taking place at all three coffee shops throughout the day.
- Lets consider how to use this data to inform our decision.

---

## Hiring a Barista
<p class="subheader">Q. Which coffee shop is the busiest?</p>

---

## Hiring a Barista: Bar Graphs Compare Shops
<p class="subheader">Q. Which coffee shop is the busiest?</p>

![](i/i_01.png)

. . .

*> a bar chart makes it easy to compare shops' busyness*

---

## Hiring a Barista
<p class="subheader">Q. What time of day is the busiest?</p>

---

## Hiring a Barista: Histograms Can Compare Times
<p class="subheader">Q. What time of day is the busiest?</p>

![](i/i_02.png)

. . .

*> a histogram makes it easy to compare transactions by time of day*

. . .

*> does this mean the morning shift at Shop A is the busiest?*

---

## Hiring a Barista
<p class="subheader">Q. Which shift is the busiest?</p>

---

## Hiring a Barista: Transactions by Shop
<p class="subheader">Q. Which shift is the busiest?</p>

![](i/i_03.png)

*> an overlaid histogram can show all three groups*

. . .

*> does this show the data clearly?*

---

## Hiring a Barista: Faceting
<p class="subheader">What if we separated each shop into its own plot?</p>

<br>

::: {.incremental}
- Overlapping histograms are hard to read
- **Solution 1:** Give each group its own plot
- This is called **faceting** or **small multiples**
:::

---

## Hiring a Barista: Faceting
<p class="subheader">Each shop gets its own panel</p>

![](i/f_01.png)

. . .

*> same data, but now each shop has its own histogram*

---

## Hiring a Barista: Faceting
<p class="subheader">Q. Which shop is busiest during the morning rush?</p>

![](i/f_01.png)

. . .

*> Shop C — compare the 8-10am peaks across panels*

---

## Hiring a Barista: Faceting
<p class="subheader">Q. Which shop has the most consistent traffic throughout the day?</p>

![](i/f_01.png)

. . .

*> Shop A — the distribution is relatively flat*

---

## Hiring a Barista: Line Graphs
<p class="subheader">**Solution 2:** Use lines instead of bars</p>

![](i/i_05.png)

*> line graphs can also show multiple groups clearly*

---

## Part 1.4 | Panel Data (Long Format)

<br><br>

#### Summary

::: {.incremental}
- **Panel data** tracks repeated observations across groups or time
- **Long format:** Each observation is a row; a column identifies the group
- **Faceting** separates each group into its own panel for comparison
- **Line graphs** simplify multiple categories on a single plot
- Use `hue='Group'` and `col='Group'` for multi-group visualizations
:::

---

## Looking Ahead: Part 1.5
<p class="subheader">Sometimes we need data in a different shape</p>

<br>

::: {.incremental}
- What if we want to compare 1999 vs 2019 directly?
- Long format makes this awkward — we'd need to filter and merge
- **Wide format** puts each time period in its own column
- In Part 1.5, we'll learn to reshape between formats
:::

---

## Exercise 1.4 | Coffee Shop Transactions
<p class="subheader">Use Coffee_Sales_Receips.csv to help inform where to hire a barista.</p>

. . .

```{.python}
# Load Dataset
sales = pd.read_csv(file_path + 'Coffee_Sales_Reciepts.csv')
sales.head()
```

. . .

```{python}
import pandas as pd
sales = pd.read_csv('data/Coffee_Sales_Reciepts.csv')
sales[['Hours', 'Shop']].head()
```

*> you'll see a few more columns in your dataset*

. . .

*> this is **Long-Format Panel Data**: transactions are all in the same column*

---

## Exercise 1.4 | Bar Chart
<p class="subheader">Use Coffee_Sales_Receips.csv to help inform where to hire a barista.</p>

```{.python}
# Bar graph
sns.countplot(sales, x='Shop', hue='Shop')
```

. . .

![](i/i_01.png)

---

## Exercise 1.4 | Histogram
<p class="subheader">Use Coffee_Sales_Receips.csv to help inform where to hire a barista.</p>

```{.python}
# Create a histogram
sns.histplot(sales, x='Hours', bins=range(0,24,1))
```

. . .

![](i/i_02.png)

---

## Exercise 1.4 | Multi-Histogram
<p class="subheader">Use Coffee_Sales_Receips.csv to help inform where to hire a barista.</p>

```{.python}
# Create a multi-histogram
sns.histplot(sales, x='Hours', hue='Shop', bins=range(0,24,1))
```

. . .

![](i/i_03.png)

---

## Exercise 1.4 | Faceted Histogram
<p class="subheader">Use faceting to give each shop its own panel.</p>

```{.python}
# Create a faceted histogram
sns.displot(sales, x='Hours', col='Shop', bins=range(0,24,1))
```

. . .

![](i/f_01.png)

---

## Exercise 1.4 | Count Hourly by Shop
<p class="subheader">Q. Which shift is the busiest?</p>

```{.python}
# Create hourly counts by shop
hourly_counts = sales.groupby(['Shop', 'Hours']).size().reset_index(name='Count')
```

. . .

```{python}
import pandas as pd
sales = pd.read_csv('data/Coffee_Sales_Reciepts.csv')
sales.groupby(['Shop', 'Hours']).size().reset_index(name='Count').head()
```

. . .

```{.python}
# Multi-Lineplot
sns.lineplot(hourly_counts, x='Hours', y='Count', hue='Shop')
```

---

## Exercise 1.4 | Multiple Line Graph
<p class="subheader">Q. Which shift is the busiest?</p>

```{.python}
# Multiple-Line Graph
sns.histplot(sales, x='Hours', hue='Shop', bins=range(0,24,1), element='poly')
```

. . .

![](i/i_04.png)

---

## Exercise 1.4 | Multiple Line Graph
<p class="subheader">Q. Which shift is the busiest?</p>

```{.python}
# Multiple-Line Graph
sns.histplot(sales, x='Hours', hue='Shop', bins=range(0,24,1), element='poly', fill=False)
```

. . .

![](i/i_05.png)

